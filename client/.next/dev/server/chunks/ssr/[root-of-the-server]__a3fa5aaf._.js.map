{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 30, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/keury/OneDrive/%C3%81rea%20de%20Trabalho/nexora/client/components/RatingModal.js"],"sourcesContent":["import { io } from \"socket.io-client\";\r\n\r\nconst socket = io(\"http://localhost:3001\");\r\n\r\nexport default function RatingModal({ partnerId, onClose }) {\r\n  function rate(rating) {\r\n    socket.emit(\"rateUser\", {\r\n      targetUserId: partnerId,\r\n      rating\r\n    });\r\n    onClose();\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <h3>Avalie seu parceiro</h3>\r\n      {[1,2,3,4,5].map(n => (\r\n        <button key={n} onClick={() => rate(n)}>\r\n          ‚≠ê {n}\r\n        </button>\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;;;;;;;AAEA,MAAM,SAAS,IAAA,+MAAE,EAAC;AAEH,SAAS,YAAY,EAAE,SAAS,EAAE,OAAO,EAAE;IACxD,SAAS,KAAK,MAAM;QAClB,OAAO,IAAI,CAAC,YAAY;YACtB,cAAc;YACd;QACF;QACA;IACF;IAEA,qBACE,qKAAC;;0BACC,qKAAC;0BAAG;;;;;;YACH;gBAAC;gBAAE;gBAAE;gBAAE;gBAAE;aAAE,CAAC,GAAG,CAAC,CAAA,kBACf,qKAAC;oBAAe,SAAS,IAAM,KAAK;;wBAAI;wBACnC;;mBADQ;;;;;;;;;;;AAMrB"}},
    {"offset": {"line": 91, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/keury/OneDrive/%C3%81rea%20de%20Trabalho/nexora/client/components/ChatWindow.js"],"sourcesContent":["import { useEffect, useState, useRef } from \"react\";\r\nimport { io } from \"socket.io-client\";\r\nimport { useRouter } from \"next/router\";\r\nimport RatingModal from \"./RatingModal\";\r\n\r\nexport default function ChatWindow() {\r\n  const router = useRouter();\r\n  const { theme } = router.query;\r\n\r\n  const socketRef = useRef(null);\r\n  const messagesEndRef = useRef(null);\r\n\r\n  const [connected, setConnected] = useState(false);\r\n  const [room, setRoom] = useState(null);\r\n  const [messages, setMessages] = useState([]);\r\n  const [input, setInput] = useState(\"\");\r\n  const [partnerId, setPartnerId] = useState(null);\r\n  const [showRating, setShowRating] = useState(false);\r\n  const [status, setStatus] = useState(\"Conectando...\");\r\n  const [typing, setTyping] = useState(false);\r\n  const [onlineCount, setOnlineCount] = useState(0);\r\n\r\n\r\n  // üî• Conex√£o\r\n  useEffect(() => {\r\n    if (!theme) return;\r\n\r\n    const socket = io(\"http://localhost:3001\");\r\n    socketRef.current = socket;\r\n\r\n\r\n    socket.on(\"blocked\", () => {\r\n  setStatus(\"‚ö†Ô∏è Voc√™ foi bloqueado por m√° reputa√ß√£o.\");\r\n  setConnected(false);\r\n});\r\n\r\n\r\n\r\n    socket.on(\"connect\", () => {\r\n      setStatus(\"Procurando parceiro...\");\r\n      socket.emit(\"joinTheme\", theme);\r\n    });\r\n\r\n    socket.on(\"onlineCount\", (count) => {\r\n      setOnlineCount(count);\r\n    });\r\n\r\n\r\n    socket.on(\"matched\", ({ room, users }) => {\r\n      setRoom(room);\r\n\r\n      const partner = users.find(\r\n        (u) => u.socketId !== socket.id\r\n      );\r\n\r\n      if (partner) {\r\n        setPartnerId(partner.userId);\r\n      }\r\n\r\n      setMessages([]);\r\n      setStatus(\"Conectado!\");\r\n      setConnected(true);\r\n    });\r\n\r\n    socket.on(\"message\", ({ text, sender }) => {\r\n      if (!text || !sender) return;\r\n\r\n      const isYou = sender === socket.id;\r\n\r\n      setMessages((prev) => [\r\n        ...prev,\r\n        {\r\n          id: Date.now() + Math.random(),\r\n          text,\r\n          sender: isYou ? \"you\" : \"partner\",\r\n        },\r\n      ]);\r\n    });\r\n\r\n    socket.on(\"typing\", (senderId) => {\r\n      if (senderId !== socket.id) {\r\n        setTyping(true);\r\n        setTimeout(() => setTyping(false), 1200);\r\n      }\r\n    });\r\n\r\n    socket.on(\"chatEnded\", () => {\r\n      setConnected(false);\r\n      setStatus(\"Conversa encerrada\");\r\n      setShowRating(true);\r\n    });\r\n\r\n    return () => {\r\n      socket.disconnect();\r\n    };\r\n  }, [theme]);\r\n\r\n  // üî• Scroll autom√°tico\r\n  useEffect(() => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\r\n  }, [messages]);\r\n\r\n  function sendMessage() {\r\n    if (!input.trim() || !room) return;\r\n\r\n    socketRef.current.emit(\"message\", {\r\n      room,\r\n      text: input,\r\n    });\r\n\r\n    setInput(\"\");\r\n  }\r\n\r\n  function nextUser() {\r\n    if (!theme) return;\r\n\r\n    setMessages([]);\r\n    setConnected(false);\r\n    setStatus(\"Procurando novo parceiro...\");\r\n    socketRef.current.emit(\"joinTheme\", theme);\r\n  }\r\n\r\n  function endChat() {\r\n    if (!room) return;\r\n    socketRef.current.emit(\"endChat\", room);\r\n  }\r\n\r\n  function handleTyping() {\r\n    if (!room) return;\r\n    socketRef.current.emit(\"typing\", room);\r\n  }\r\n\r\n  return (\r\n    <div className=\"container\">\r\n      <h2 className=\"title\">Nexora ‚Äî {theme}</h2>\r\n      <p className=\"status\">{status}</p>\r\n\r\n      <div className=\"chat-box\">\r\n        {messages.map((m) => (\r\n          <div\r\n            key={m.id}\r\n            className={`message ${m.sender}`}\r\n          >\r\n            <span className=\"label\">\r\n              {m.sender === \"you\" ? \"VOC√ä\" : \"ESTRANHO\"}\r\n            </span>\r\n            <div>{m.text}</div>\r\n          </div>\r\n        ))}\r\n\r\n        {typing && (\r\n          <div className=\"message partner\">\r\n            <em>Estranho est√° digitando...</em>\r\n          </div>\r\n        )}\r\n\r\n        <div ref={messagesEndRef} />\r\n      </div>\r\n\r\n      {connected && (\r\n        <>\r\n          <div className=\"input-area\">\r\n            <input\r\n              value={input}\r\n              onChange={(e) => {\r\n                setInput(e.target.value);\r\n                handleTyping();\r\n              }}\r\n              placeholder=\"Digite sua mensagem...\"\r\n              onKeyDown={(e) => {\r\n                if (e.key === \"Enter\") sendMessage();\r\n              }}\r\n            />\r\n            <button className=\"primary\" onClick={sendMessage}>\r\n              Enviar\r\n            </button>\r\n          </div>\r\n\r\n          <div className=\"actions\">\r\n            <button className=\"secondary\" onClick={nextUser}>\r\n              Pr√≥ximo\r\n            </button>\r\n            <button className=\"secondary danger\" onClick={endChat}>\r\n              Encerrar\r\n            </button>\r\n          </div>\r\n        \r\n        <p className=\"online\">\r\n  üî• {onlineCount} pessoas online agora\r\n</p>\r\n\r\n        </>\r\n      )}\r\n\r\n      {showRating && partnerId && (\r\n        <RatingModal\r\n          partnerId={partnerId}\r\n          onClose={() => setShowRating(false)}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 384, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/keury/OneDrive/%C3%81rea%20de%20Trabalho/nexora/client/pages/chat.js"],"sourcesContent":["import ChatWindow from \"../components/ChatWindow\";\r\n\r\nexport default function Chat() {\r\n  return <ChatWindow />;\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;;;;;;;AAEe,SAAS;IACtB,qBAAO,qKAAC,4HAAU;;;;;AACpB"}}]
}